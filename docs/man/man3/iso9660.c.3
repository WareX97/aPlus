.TH "src/fs/iso9660/iso9660.c" 3 "Sun Nov 9 2014" "Version 0.1" "aPlus" \" -*- nroff -*-
.ad l
.nh
.SH NAME
src/fs/iso9660/iso9660.c \- 
.SH SYNOPSIS
.br
.PP
\fC#include <aplus\&.h>\fP
.br
\fC#include <aplus/fs\&.h>\fP
.br
\fC#include <aplus/task\&.h>\fP
.br
\fC#include <stdint\&.h>\fP
.br
\fC#include <string\&.h>\fP
.br
\fC#include <unistd\&.h>\fP
.br
\fC#include <dirent\&.h>\fP
.br
\fC#include <fcntl\&.h>\fP
.br
\fC#include <sys/types\&.h>\fP
.br
\fC#include 'iso9660\&.h'\fP
.br

.SS "Functions"

.in +1c
.ti -1c
.RI "\fBuint32_t\fP \fBiso9660_getroot\fP (\fBinode_t\fP *dev)"
.br
.ti -1c
.RI "int \fBiso9660_check\fP (\fBinode_t\fP *dev)"
.br
.ti -1c
.RI "void \fBiso9660_checkname\fP (char *\fBname\fP)"
.br
.ti -1c
.RI "\fBuint16_t\fP \fBiso9660_getmsb16\fP (\fBuint32_t\fP val)"
.br
.ti -1c
.RI "\fBuint32_t\fP \fBiso9660_getmsb32\fP (uint64_t val)"
.br
.ti -1c
.RI "\fBuint16_t\fP \fBiso9660_getlsb16\fP (\fBuint32_t\fP val)"
.br
.ti -1c
.RI "\fBuint32_t\fP \fBiso9660_getlsb32\fP (uint64_t val)"
.br
.in -1c
.SH "Function Documentation"
.PP 
.SS "int iso9660_check (\fBinode_t\fP *dev)"

.PP
Definition at line 31 of file iso9660\&.c\&.
.PP
References fs_read(), ISO9660_ID, ISO9660_PVD, ISO9660_VOLDESC_SIZE, kfree(), kmalloc(), and inode::position\&.
.PP
.nf
31                                 {
32     iso9660_pvd_t* pvd = (iso9660_pvd_t*) kmalloc(ISO9660_VOLDESC_SIZE);
33     memset(pvd, 0, ISO9660_VOLDESC_SIZE);
34 
35     dev->position = ISO9660_PVD;
36     if(fs_read(dev, pvd, ISO9660_VOLDESC_SIZE) != ISO9660_VOLDESC_SIZE) {
37         kfree(pvd);
38         return 0;
39     }
40 
41     int ret = strncmp(pvd->id, ISO9660_ID, 5);
42     kfree(pvd);
43 
44     return ret;
45 }
.fi
.SS "void iso9660_checkname (char *name)"

.PP
Definition at line 47 of file iso9660\&.c\&.
.PP
.nf
47                                    {
48     char* p = strchr(name, ';');
49     if(p) {
50         *p-- = 0;
51     
52         if(*p == '\&.')
53             *p = 0;
54     }
55 
56     for(int i = 0; i < strlen(name); i++)
57         if(name[i] >= 'A' && name[i] <= 'Z')
58             name[i] += 32;
59 }
.fi
.SS "\fBuint16_t\fP iso9660_getlsb16 (\fBuint32_t\fPval)"

.PP
Definition at line 69 of file iso9660\&.c\&.
.PP
.nf
69                                         {
70     return (val >> 0) & 0xFFFF;
71 }
.fi
.SS "\fBuint32_t\fP iso9660_getlsb32 (uint64_tval)"

.PP
Definition at line 73 of file iso9660\&.c\&.
.PP
.nf
73                                         {
74     return (val >> 0) & 0xFFFFFFFF;
75 }
.fi
.SS "\fBuint16_t\fP iso9660_getmsb16 (\fBuint32_t\fPval)"

.PP
Definition at line 61 of file iso9660\&.c\&.
.PP
.nf
61                                         {
62     return (val >> 16) & 0xFFFF;
63 }
.fi
.SS "\fBuint32_t\fP iso9660_getmsb32 (uint64_tval)"

.PP
Definition at line 65 of file iso9660\&.c\&.
.PP
.nf
65                                         {
66     return (val >> 32) & 0xFFFFFFFF;
67 }
.fi
.SS "\fBuint32_t\fP iso9660_getroot (\fBinode_t\fP *dev)"

.PP
Definition at line 14 of file iso9660\&.c\&.
.PP
References fs_read(), ISO9660_PVD, ISO9660_VOLDESC_SIZE, kfree(), kmalloc(), inode::position, and uint32_t\&.
.PP
.nf
14                                        {
15     iso9660_pvd_t* pvd = (iso9660_pvd_t*) kmalloc(ISO9660_VOLDESC_SIZE);
16     memset(pvd, 0, ISO9660_VOLDESC_SIZE);
17 
18     dev->position = ISO9660_PVD;
19     if(fs_read(dev, pvd, ISO9660_VOLDESC_SIZE) != ISO9660_VOLDESC_SIZE) {
20         kfree(pvd);
21         return 0;
22     }
23 
24     uint32_t ret = (uint32_t) pvd->rootdir;
25     kfree(pvd);
26 
27     return ret;
28 }
.fi
.SH "Author"
.PP 
Generated automatically by Doxygen for aPlus from the source code\&.
