\hypertarget{fstat_8c}{\section{src/syscall/fstat.c File Reference}
\label{fstat_8c}\index{src/syscall/fstat.\+c@{src/syscall/fstat.\+c}}
}
{\ttfamily \#include $<$aplus.\+h$>$}\\*
{\ttfamily \#include $<$aplus/syscall.\+h$>$}\\*
{\ttfamily \#include $<$aplus/fs.\+h$>$}\\*
{\ttfamily \#include $<$aplus/task.\+h$>$}\\*
{\ttfamily \#include $<$unistd.\+h$>$}\\*
{\ttfamily \#include $<$fcntl.\+h$>$}\\*
{\ttfamily \#include $<$errno.\+h$>$}\\*
{\ttfamily \#include $<$sys/stat.\+h$>$}\\*
{\ttfamily \#include $<$dirent.\+h$>$}\\*
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{fstat_8c_a37940479e5cc923a96785a82989b7974}{sys\+\_\+fstat} (int fd, struct stat $\ast$st)
\begin{DoxyCompactList}\small\item\em This function shall obtain information about an open file associated with the file descriptor fildes, and shall write it to the area pointed to by buf. \end{DoxyCompactList}\item 
\hyperlink{fstat_8c_a4d257934d85058e9d4821db299a6544d}{S\+Y\+S\+C\+A\+L\+L} (\hyperlink{fstat_8c_a37940479e5cc923a96785a82989b7974}{sys\+\_\+fstat}, 4)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hyperlink{task_8h_a8aeef2cdb643462b97cd459a8e68cad3}{task\+\_\+t} $\ast$ \hyperlink{fstat_8c_a4743b3673a8794b8e7bd0b6c91a63cd5}{current\+\_\+task}
\begin{DoxyCompactList}\small\item\em Current task address. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Function Documentation}
\hypertarget{fstat_8c_a37940479e5cc923a96785a82989b7974}{\index{fstat.\+c@{fstat.\+c}!sys\+\_\+fstat@{sys\+\_\+fstat}}
\index{sys\+\_\+fstat@{sys\+\_\+fstat}!fstat.\+c@{fstat.\+c}}
\subsubsection[{sys\+\_\+fstat}]{\setlength{\rightskip}{0pt plus 5cm}int sys\+\_\+fstat (
\begin{DoxyParamCaption}
\item[{int}]{fd, }
\item[{struct stat $\ast$}]{st}
\end{DoxyParamCaption}
)}}\label{fstat_8c_a37940479e5cc923a96785a82989b7974}


This function shall obtain information about an open file associated with the file descriptor fildes, and shall write it to the area pointed to by buf. 


\begin{DoxyParams}{Parameters}
{\em fd} & File descriptor \\
\hline
{\em st} & Stat structure \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Upon successful completion, 0 shall be returned.~\newline
 Otherwise, -\/1 shall be returned and errno set to indicate the error. 
\end{DoxyReturn}


Definition at line 24 of file fstat.\+c.



References inode\+::atime, inode\+::ctime, inode\+::dev, errno, task\+::fd, inode\+::gid, inode\+::ino, inode\+::mode, inode\+::mtime, inode\+::nlink, inode\+::rdev, inode\+::size, T\+A\+S\+K\+\_\+\+M\+A\+X\+\_\+\+F\+D, and inode\+::uid.


\begin{DoxyCode}
24                                        \{
25     \textcolor{keywordflow}{if}(!st) \{
26         \hyperlink{errno_8c_ad65a8842cc674e3ddf69355898c0ecbf}{errno} = EINVAL;
27         \textcolor{keywordflow}{return} -1;
28     \}
29 
30     \textcolor{keywordflow}{if}(fd < 0 || fd > \hyperlink{task_8h_aa0beab24d02a2ccd5d273dea188af93d}{TASK\_MAX\_FD}) \{
31         \hyperlink{errno_8c_ad65a8842cc674e3ddf69355898c0ecbf}{errno} = EBADF;
32         \textcolor{keywordflow}{return} -1;
33     \}
34     
35 
36     \hyperlink{structinode}{inode\_t}* ino = \hyperlink{fstat_8c_a4743b3673a8794b8e7bd0b6c91a63cd5}{current\_task}->\hyperlink{structtask_afeeb6bafaefe505e6a730dd4e0be5a1a}{fd}[fd];
37     \textcolor{keywordflow}{if}(!ino) \{
38         \hyperlink{errno_8c_ad65a8842cc674e3ddf69355898c0ecbf}{errno} = EBADF;
39         \textcolor{keywordflow}{return} -1;
40     \}
41     
42     st->st\_mode = ino->\hyperlink{structinode_a4902d9f6a1d7bd79c6f1bb73d83ce8e3}{mode};
43     st->st\_ino = ino->\hyperlink{structinode_a1a77be0f24a6c9a18bbdbcecfb75df7c}{ino};
44     st->st\_dev = ino->\hyperlink{structinode_a127a2eb030df332fa64a81188731ad6b}{dev};
45     st->st\_uid = ino->\hyperlink{structinode_a0eac94e96ded19029e871d5cce815bcb}{uid};
46     st->st\_gid = ino->\hyperlink{structinode_a8434fb9dd05057d00b37ed713713835d}{gid};
47     st->st\_atime = ino->\hyperlink{structinode_a7e52661a115f6def97778566f2be0d80}{atime};
48     st->st\_ctime = ino->\hyperlink{structinode_a27334a9d3c25fbac1c134ed5b9cbc566}{ctime};
49     st->st\_mtime = ino->\hyperlink{structinode_a19f0d407fa2962c942e406d3e00c1da4}{mtime};
50     st->st\_nlink = ino->\hyperlink{structinode_a1daedc820c86b5af32f0a137419f7a8f}{nlink};
51     st->st\_size = ino->\hyperlink{structinode_a53722b1b60b7136ce0204b66527bb400}{size};
52     st->st\_rdev = ino->\hyperlink{structinode_a3e7613383954ff7b5faf7c2188e1f61b}{rdev};
53     st->st\_blksize = 512;
54     st->st\_blocks = st->st\_size / st->st\_blksize;
55     
56     \textcolor{keywordflow}{return} 0;
57 \}
\end{DoxyCode}
\hypertarget{fstat_8c_a4d257934d85058e9d4821db299a6544d}{\index{fstat.\+c@{fstat.\+c}!S\+Y\+S\+C\+A\+L\+L@{S\+Y\+S\+C\+A\+L\+L}}
\index{S\+Y\+S\+C\+A\+L\+L@{S\+Y\+S\+C\+A\+L\+L}!fstat.\+c@{fstat.\+c}}
\subsubsection[{S\+Y\+S\+C\+A\+L\+L}]{\setlength{\rightskip}{0pt plus 5cm}S\+Y\+S\+C\+A\+L\+L (
\begin{DoxyParamCaption}
\item[{{\bf sys\+\_\+fstat}}]{, }
\item[{4}]{}
\end{DoxyParamCaption}
)}}\label{fstat_8c_a4d257934d85058e9d4821db299a6544d}


\subsection{Variable Documentation}
\hypertarget{fstat_8c_a4743b3673a8794b8e7bd0b6c91a63cd5}{\index{fstat.\+c@{fstat.\+c}!current\+\_\+task@{current\+\_\+task}}
\index{current\+\_\+task@{current\+\_\+task}!fstat.\+c@{fstat.\+c}}
\subsubsection[{current\+\_\+task}]{\setlength{\rightskip}{0pt plus 5cm}{\bf task\+\_\+t}$\ast$ current\+\_\+task}}\label{fstat_8c_a4743b3673a8794b8e7bd0b6c91a63cd5}


Current task address. 



Definition at line 37 of file sched.\+c.

