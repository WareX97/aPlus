\hypertarget{chown_8c}{\section{src/syscall/chown.c File Reference}
\label{chown_8c}\index{src/syscall/chown.\+c@{src/syscall/chown.\+c}}
}
{\ttfamily \#include $<$aplus.\+h$>$}\\*
{\ttfamily \#include $<$aplus/syscall.\+h$>$}\\*
{\ttfamily \#include $<$aplus/task.\+h$>$}\\*
{\ttfamily \#include $<$aplus/fs.\+h$>$}\\*
{\ttfamily \#include $<$errno.\+h$>$}\\*
{\ttfamily \#include $<$unistd.\+h$>$}\\*
{\ttfamily \#include $<$fcntl.\+h$>$}\\*
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{chown_8c_a20e2eec32e2e19fd93c7ecbe00277a89}{sys\+\_\+chown} (char $\ast$filename, uid\+\_\+t owner, gid\+\_\+t group)
\begin{DoxyCompactList}\small\item\em Changes the ownership of the file specified by pathname, which is dereferenced if it is a symbolic link. \end{DoxyCompactList}\item 
\hyperlink{chown_8c_a72db0d5fe4733e59ef6b0dd96495a4d1}{S\+Y\+S\+C\+A\+L\+L} (\hyperlink{chown_8c_a20e2eec32e2e19fd93c7ecbe00277a89}{sys\+\_\+chown}, 21)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hyperlink{task_8h_a8aeef2cdb643462b97cd459a8e68cad3}{task\+\_\+t} $\ast$ \hyperlink{chown_8c_a4743b3673a8794b8e7bd0b6c91a63cd5}{current\+\_\+task}
\begin{DoxyCompactList}\small\item\em Current task address. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Function Documentation}
\hypertarget{chown_8c_a20e2eec32e2e19fd93c7ecbe00277a89}{\index{chown.\+c@{chown.\+c}!sys\+\_\+chown@{sys\+\_\+chown}}
\index{sys\+\_\+chown@{sys\+\_\+chown}!chown.\+c@{chown.\+c}}
\subsubsection[{sys\+\_\+chown}]{\setlength{\rightskip}{0pt plus 5cm}int sys\+\_\+chown (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{filename, }
\item[{uid\+\_\+t}]{owner, }
\item[{gid\+\_\+t}]{group}
\end{DoxyParamCaption}
)}}\label{chown_8c_a20e2eec32e2e19fd93c7ecbe00277a89}


Changes the ownership of the file specified by pathname, which is dereferenced if it is a symbolic link. 


\begin{DoxyParams}{Parameters}
{\em filename} & \\
\hline
{\em owner} & \\
\hline
{\em group} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
On success, zero is returned. On error, âˆ’1 is returned, and errno is set appropriately. 
\end{DoxyReturn}


Definition at line 21 of file chown.\+c.



References errno, task\+::fd, fs\+\_\+chown(), im\+\_\+superuser(), kprintf(), and sys\+\_\+open().


\begin{DoxyCode}
21                                                         \{
22     \textcolor{keywordflow}{if}(!\hyperlink{src_2sched_8c_a11eb67cd27beaf272f76796f65d1ca1c}{im\_superuser}()) \{
23         \hyperlink{debug_8c_ac9d768b4772cc87fc88afbbbd805f96a}{kprintf}(\textcolor{stringliteral}{"sys\_chown: only superuser allow to use this function."});
24         
25         \hyperlink{errno_8c_ad65a8842cc674e3ddf69355898c0ecbf}{errno} = EACCES;
26         \textcolor{keywordflow}{return} -1;
27     \}
28     
29     
30     \textcolor{keywordtype}{int} fd = \hyperlink{open_8c_ab7835c4352479c7a3d7af78c138e81c1}{sys\_open}(filename, O\_RDONLY, 0644);
31     \textcolor{keywordflow}{if}(fd < 0)
32         \textcolor{keywordflow}{return} -1;
33     
34     
35     \hyperlink{structinode}{inode\_t}* ino = \hyperlink{chown_8c_a4743b3673a8794b8e7bd0b6c91a63cd5}{current\_task}->\hyperlink{structtask_afeeb6bafaefe505e6a730dd4e0be5a1a}{fd}[fd];
36     \textcolor{keywordflow}{return} \hyperlink{fs_8c_a2928203c42eba392963b57bfed7b65c4}{fs\_chown}(ino, owner, group);
37 \}
\end{DoxyCode}
\hypertarget{chown_8c_a72db0d5fe4733e59ef6b0dd96495a4d1}{\index{chown.\+c@{chown.\+c}!S\+Y\+S\+C\+A\+L\+L@{S\+Y\+S\+C\+A\+L\+L}}
\index{S\+Y\+S\+C\+A\+L\+L@{S\+Y\+S\+C\+A\+L\+L}!chown.\+c@{chown.\+c}}
\subsubsection[{S\+Y\+S\+C\+A\+L\+L}]{\setlength{\rightskip}{0pt plus 5cm}S\+Y\+S\+C\+A\+L\+L (
\begin{DoxyParamCaption}
\item[{{\bf sys\+\_\+chown}}]{, }
\item[{21}]{}
\end{DoxyParamCaption}
)}}\label{chown_8c_a72db0d5fe4733e59ef6b0dd96495a4d1}


\subsection{Variable Documentation}
\hypertarget{chown_8c_a4743b3673a8794b8e7bd0b6c91a63cd5}{\index{chown.\+c@{chown.\+c}!current\+\_\+task@{current\+\_\+task}}
\index{current\+\_\+task@{current\+\_\+task}!chown.\+c@{chown.\+c}}
\subsubsection[{current\+\_\+task}]{\setlength{\rightskip}{0pt plus 5cm}{\bf task\+\_\+t}$\ast$ current\+\_\+task}}\label{chown_8c_a4743b3673a8794b8e7bd0b6c91a63cd5}


Current task address. 



Definition at line 37 of file sched.\+c.

