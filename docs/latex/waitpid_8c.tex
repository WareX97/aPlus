\hypertarget{waitpid_8c}{\section{src/syscall/waitpid.c File Reference}
\label{waitpid_8c}\index{src/syscall/waitpid.\+c@{src/syscall/waitpid.\+c}}
}
{\ttfamily \#include $<$aplus.\+h$>$}\\*
{\ttfamily \#include $<$aplus/syscall.\+h$>$}\\*
{\ttfamily \#include $<$aplus/fs.\+h$>$}\\*
{\ttfamily \#include $<$aplus/task.\+h$>$}\\*
{\ttfamily \#include $<$unistd.\+h$>$}\\*
{\ttfamily \#include $<$fcntl.\+h$>$}\\*
{\ttfamily \#include $<$errno.\+h$>$}\\*
{\ttfamily \#include $<$sys/wait.\+h$>$}\\*
{\ttfamily \#include $<$sys/types.\+h$>$}\\*
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{waitpid_8c_a6b16504dd1c74be11c75e5739f9906f1}{sys\+\_\+waitpid} (pid\+\_\+t pid, int $\ast$status, int options)
\item 
\hyperlink{waitpid_8c_a202384fbf44c4383fb36d9fe3c746b00}{S\+Y\+S\+C\+A\+L\+L} (\hyperlink{waitpid_8c_a6b16504dd1c74be11c75e5739f9906f1}{sys\+\_\+waitpid}, 31)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hyperlink{task_8h_a8aeef2cdb643462b97cd459a8e68cad3}{task\+\_\+t} $\ast$ \hyperlink{waitpid_8c_a4743b3673a8794b8e7bd0b6c91a63cd5}{current\+\_\+task}
\begin{DoxyCompactList}\small\item\em Current task address. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Function Documentation}
\hypertarget{waitpid_8c_a6b16504dd1c74be11c75e5739f9906f1}{\index{waitpid.\+c@{waitpid.\+c}!sys\+\_\+waitpid@{sys\+\_\+waitpid}}
\index{sys\+\_\+waitpid@{sys\+\_\+waitpid}!waitpid.\+c@{waitpid.\+c}}
\subsubsection[{sys\+\_\+waitpid}]{\setlength{\rightskip}{0pt plus 5cm}int sys\+\_\+waitpid (
\begin{DoxyParamCaption}
\item[{pid\+\_\+t}]{pid, }
\item[{int $\ast$}]{status, }
\item[{int}]{options}
\end{DoxyParamCaption}
)}}\label{waitpid_8c_a6b16504dd1c74be11c75e5739f9906f1}


Definition at line 15 of file waitpid.\+c.



References errno, task\+::pid, schedule\+\_\+child(), schedule\+\_\+getbypid(), and schedule\+\_\+wait().


\begin{DoxyCode}
15                                                      \{
16     \textcolor{keywordflow}{if}(\hyperlink{waitpid_8c_a4743b3673a8794b8e7bd0b6c91a63cd5}{current\_task} == NULL) \{
17         \hyperlink{errno_8c_ad65a8842cc674e3ddf69355898c0ecbf}{errno} = EFAULT;
18         \textcolor{keywordflow}{return} -1;
19     \}
20 
21 
22     \hyperlink{structtask}{task\_t}* child = NULL;
23 
24     \textcolor{keywordflow}{if}(pid == -1)
25         child = (\hyperlink{structtask}{task\_t}*) \hyperlink{src_2sched_8c_a96793377662f91213568fe44bf4eccad}{schedule\_child}();
26     \textcolor{keywordflow}{else}
27         child = (\hyperlink{structtask}{task\_t}*) \hyperlink{src_2sched_8c_afcc9c5ea77b2a3aaafc7bdf896d9d633}{schedule\_getbypid}(pid);
28 
29 
30     \textcolor{keywordflow}{if}(child == NULL) \{
31         \hyperlink{errno_8c_ad65a8842cc674e3ddf69355898c0ecbf}{errno} = ECHILD;
32         \textcolor{keywordflow}{return} -1;
33     \}
34 
35     \textcolor{keywordflow}{if}(options == WNOHANG)
36         \textcolor{keywordflow}{return} child->\hyperlink{structtask_ab56448ae42a75825ea923bd86648f3ae}{pid};
37 
38     \textcolor{keywordtype}{int} exitcode = \hyperlink{src_2sched_8c_a74e91e3418aedd28c8ddf5d150859a70}{schedule\_wait}(child);
39 
40     \textcolor{keywordflow}{if}(status)
41         *status = exitcode;
42 
43     \textcolor{keywordflow}{return} child->\hyperlink{structtask_ab56448ae42a75825ea923bd86648f3ae}{pid};
44 \}
\end{DoxyCode}
\hypertarget{waitpid_8c_a202384fbf44c4383fb36d9fe3c746b00}{\index{waitpid.\+c@{waitpid.\+c}!S\+Y\+S\+C\+A\+L\+L@{S\+Y\+S\+C\+A\+L\+L}}
\index{S\+Y\+S\+C\+A\+L\+L@{S\+Y\+S\+C\+A\+L\+L}!waitpid.\+c@{waitpid.\+c}}
\subsubsection[{S\+Y\+S\+C\+A\+L\+L}]{\setlength{\rightskip}{0pt plus 5cm}S\+Y\+S\+C\+A\+L\+L (
\begin{DoxyParamCaption}
\item[{{\bf sys\+\_\+waitpid}}]{, }
\item[{31}]{}
\end{DoxyParamCaption}
)}}\label{waitpid_8c_a202384fbf44c4383fb36d9fe3c746b00}


\subsection{Variable Documentation}
\hypertarget{waitpid_8c_a4743b3673a8794b8e7bd0b6c91a63cd5}{\index{waitpid.\+c@{waitpid.\+c}!current\+\_\+task@{current\+\_\+task}}
\index{current\+\_\+task@{current\+\_\+task}!waitpid.\+c@{waitpid.\+c}}
\subsubsection[{current\+\_\+task}]{\setlength{\rightskip}{0pt plus 5cm}{\bf task\+\_\+t}$\ast$ current\+\_\+task}}\label{waitpid_8c_a4743b3673a8794b8e7bd0b6c91a63cd5}


Current task address. 



Definition at line 37 of file sched.\+c.

