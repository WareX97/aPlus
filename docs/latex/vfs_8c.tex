\hypertarget{vfs_8c}{\section{Riferimenti per il file src/fs/vfs.c}
\label{vfs_8c}\index{src/fs/vfs.\+c@{src/fs/vfs.\+c}}
}
{\ttfamily \#include $<$aplus.\+h$>$}\\*
{\ttfamily \#include $<$aplus/fs.\+h$>$}\\*
{\ttfamily \#include $<$aplus/list.\+h$>$}\\*
{\ttfamily \#include $<$stdint.\+h$>$}\\*
{\ttfamily \#include $<$stddef.\+h$>$}\\*
{\ttfamily \#include $<$unistd.\+h$>$}\\*
{\ttfamily \#include $<$sys/stat.\+h$>$}\\*
{\ttfamily \#include $<$sys/types.\+h$>$}\\*
{\ttfamily \#include $<$fcntl.\+h$>$}\\*
{\ttfamily \#include $<$dirent.\+h$>$}\\*
{\ttfamily \#include $<$errno.\+h$>$}\\*
\subsection*{Funzioni}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{vfs_8c_acb87c78588a46c5526e933c495b69c2a}{vfs\+\_\+map} (\hyperlink{fs_8h_a48b686d0c4375b0d1aab2296dc36c7a6}{inode\+\_\+t} $\ast$\hyperlink{structinode}{inode})
\item 
void \hyperlink{vfs_8c_a13a7520e2fe9380c3ed93472d0c800bc}{vfs\+\_\+umap} (\hyperlink{fs_8h_a48b686d0c4375b0d1aab2296dc36c7a6}{inode\+\_\+t} $\ast$\hyperlink{structinode}{inode})
\item 
\hyperlink{fs_8h_a48b686d0c4375b0d1aab2296dc36c7a6}{inode\+\_\+t} $\ast$ \hyperlink{vfs_8c_a99334446cfc1dfc32088d838b4f2895c}{vfs\+\_\+mapped} (\hyperlink{fs_8h_a48b686d0c4375b0d1aab2296dc36c7a6}{inode\+\_\+t} $\ast$parent, char $\ast$\hyperlink{attribute_8h_aae08e5b919f01beb6c69d2859e0dfc27}{name})
\item 
\hyperlink{fs_8h_a48b686d0c4375b0d1aab2296dc36c7a6}{inode\+\_\+t} $\ast$ \hyperlink{vfs_8c_a4f7b5f17ac7c4b3a0a574d9620e0512d}{vfs\+\_\+mapped\+\_\+at\+\_\+index} (\hyperlink{fs_8h_a48b686d0c4375b0d1aab2296dc36c7a6}{inode\+\_\+t} $\ast$parent, int index)
\item 
int \hyperlink{vfs_8c_a829e1c063db610c46554db0e28cb2bcb}{vfs\+\_\+mapped\+\_\+count} (\hyperlink{fs_8h_a48b686d0c4375b0d1aab2296dc36c7a6}{inode\+\_\+t} $\ast$parent)
\item 
int \hyperlink{vfs_8c_ac571ec2fcf268f322214b46a0a8c7e74}{vfs\+\_\+chroot} (\hyperlink{fs_8h_a48b686d0c4375b0d1aab2296dc36c7a6}{inode\+\_\+t} $\ast$root)
\item 
int \hyperlink{vfs_8c_aca585ca14c08d6c1a07e1b886fc9749a}{vfs\+\_\+init} ()
\end{DoxyCompactItemize}
\subsection*{Variabili}
\begin{DoxyCompactItemize}
\item 
static \hyperlink{list_8h_af629e6a6713d7de11eab50cbe6449b06}{list\+\_\+t} $\ast$ \hyperlink{vfs_8c_ab78229df5c858687756417b32ac398ff}{list\+\_\+inodes} = 0
\item 
static \hyperlink{aplus_8h_a53a0df51603c77c2aa5b9ea61b606a82}{uint32\+\_\+t} \hyperlink{vfs_8c_ad11ac1a0eb756180b648d9ac7d53b169}{nextinode} = 0
\item 
\hyperlink{fs_8h_a48b686d0c4375b0d1aab2296dc36c7a6}{inode\+\_\+t} $\ast$ \hyperlink{vfs_8c_a9af8258c3554800f6613f8147544225f}{vfs\+\_\+root}
\end{DoxyCompactItemize}


\subsection{Documentazione delle funzioni}
\hypertarget{vfs_8c_ac571ec2fcf268f322214b46a0a8c7e74}{\index{vfs.\+c@{vfs.\+c}!vfs\+\_\+chroot@{vfs\+\_\+chroot}}
\index{vfs\+\_\+chroot@{vfs\+\_\+chroot}!vfs.\+c@{vfs.\+c}}
\subsubsection[{vfs\+\_\+chroot}]{\setlength{\rightskip}{0pt plus 5cm}int vfs\+\_\+chroot (
\begin{DoxyParamCaption}
\item[{{\bf inode\+\_\+t} $\ast$}]{root}
\end{DoxyParamCaption}
)}}\label{vfs_8c_ac571ec2fcf268f322214b46a0a8c7e74}


Definizione alla linea 72 del file vfs.\+c.



Referenzia inode\+::parent.


\begin{DoxyCode}
72                               \{
73     \hyperlink{vfs_8c_a9af8258c3554800f6613f8147544225f}{vfs\_root} = root;
74     \hyperlink{vfs_8c_a9af8258c3554800f6613f8147544225f}{vfs\_root}->\hyperlink{structinode_a2d4fac4ae14332628e6fa2bd55dd3121}{parent} = 0;
75     
76     \textcolor{keywordflow}{return} 0;
77 \}
\end{DoxyCode}
\hypertarget{vfs_8c_aca585ca14c08d6c1a07e1b886fc9749a}{\index{vfs.\+c@{vfs.\+c}!vfs\+\_\+init@{vfs\+\_\+init}}
\index{vfs\+\_\+init@{vfs\+\_\+init}!vfs.\+c@{vfs.\+c}}
\subsubsection[{vfs\+\_\+init}]{\setlength{\rightskip}{0pt plus 5cm}int vfs\+\_\+init (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{vfs_8c_aca585ca14c08d6c1a07e1b886fc9749a}


Definizione alla linea 81 del file vfs.\+c.



Referenzia inode\+::chown, inode\+::creat, inode\+::dev, inode\+::finddir, inode\+::flush, inode\+::gid, G\+I\+D\+\_\+\+R\+O\+O\+T, inode\+::ino, inode\+::ioctl, kmalloc(), inode\+::link, list\+\_\+add(), list\+\_\+init, inode\+::mode, inode\+::name, nextinode, inode\+::nlink, inode\+::parent, inode\+::rdev, inode\+::read, inode\+::readdir, inode\+::rename, inode\+::size, inode\+::uid, U\+I\+D\+\_\+\+R\+O\+O\+T, inode\+::unlink, e inode\+::write.


\begin{DoxyCode}
81                \{
82     \hyperlink{list_8h_aa288c0785df071ed8643763202928c82}{list\_init}(\hyperlink{vfs_8c_ab78229df5c858687756417b32ac398ff}{list\_inodes});
83     
84     
85     \hyperlink{vfs_8c_a9af8258c3554800f6613f8147544225f}{vfs\_root} = (\hyperlink{structinode}{inode\_t}*) \hyperlink{mm_8h_a1f5d4240b2decc62c0e6eae06c72916c}{kmalloc}(\textcolor{keyword}{sizeof}(\hyperlink{structinode}{inode\_t}));
86     \hyperlink{vfs_8c_a9af8258c3554800f6613f8147544225f}{vfs\_root}->\hyperlink{structinode_ad64802d9d4ebdd1c56af5ab6e302faf0}{name}[0] = \textcolor{charliteral}{'/'};
87     \hyperlink{vfs_8c_a9af8258c3554800f6613f8147544225f}{vfs\_root}->\hyperlink{structinode_ad64802d9d4ebdd1c56af5ab6e302faf0}{name}[1] = 0;
88     
89     \hyperlink{vfs_8c_a9af8258c3554800f6613f8147544225f}{vfs\_root}->\hyperlink{structinode_a127a2eb030df332fa64a81188731ad6b}{dev} = (dev\_t) 0;
90     \hyperlink{vfs_8c_a9af8258c3554800f6613f8147544225f}{vfs\_root}->\hyperlink{structinode_a1a77be0f24a6c9a18bbdbcecfb75df7c}{ino} = (ino\_t) \hyperlink{vfs_8c_ad11ac1a0eb756180b648d9ac7d53b169}{nextinode}++;
91     \hyperlink{vfs_8c_a9af8258c3554800f6613f8147544225f}{vfs\_root}->\hyperlink{structinode_a4902d9f6a1d7bd79c6f1bb73d83ce8e3}{mode} = S\_IFDIR;
92     \hyperlink{vfs_8c_a9af8258c3554800f6613f8147544225f}{vfs\_root}->\hyperlink{structinode_a1daedc820c86b5af32f0a137419f7a8f}{nlink} = 0;
93     \hyperlink{vfs_8c_a9af8258c3554800f6613f8147544225f}{vfs\_root}->\hyperlink{structinode_a0eac94e96ded19029e871d5cce815bcb}{uid} = \hyperlink{fs_8h_a9cf90243a3f4070f29ff12e5740e4ae4}{UID\_ROOT};
94     \hyperlink{vfs_8c_a9af8258c3554800f6613f8147544225f}{vfs\_root}->\hyperlink{structinode_a8434fb9dd05057d00b37ed713713835d}{gid} = \hyperlink{fs_8h_a2a5a81b6a48db264d1ec6048268ea154}{GID\_ROOT};
95     \hyperlink{vfs_8c_a9af8258c3554800f6613f8147544225f}{vfs\_root}->\hyperlink{structinode_a3e7613383954ff7b5faf7c2188e1f61b}{rdev} = (dev\_t) 0;
96     \hyperlink{vfs_8c_a9af8258c3554800f6613f8147544225f}{vfs\_root}->\hyperlink{structinode_a53722b1b60b7136ce0204b66527bb400}{size} = (size\_t) 0;
97     \textcolor{comment}{//vfs\_root->atime = vfs\_root->ctime = vfs\_root->mtime = time(NULL);}
98     \hyperlink{vfs_8c_a9af8258c3554800f6613f8147544225f}{vfs\_root}->\hyperlink{structinode_a2d4fac4ae14332628e6fa2bd55dd3121}{parent} = (\hyperlink{structinode}{inode\_t}*) NULL;
99     \hyperlink{vfs_8c_a9af8258c3554800f6613f8147544225f}{vfs\_root}->\hyperlink{structinode_a3533c53c5391601c66b3ae0f389c0843}{link} = (\hyperlink{structinode}{inode\_t}*) NULL;
100     
101     \hyperlink{vfs_8c_a9af8258c3554800f6613f8147544225f}{vfs\_root}->\hyperlink{structinode_ae2c5e8a0a372334b97024fbd9ef694c1}{read} = NULL;
102     \hyperlink{vfs_8c_a9af8258c3554800f6613f8147544225f}{vfs\_root}->\hyperlink{structinode_a53a123d38834fa17e7ef5c1e5f47bba2}{write} = NULL;
103     \hyperlink{vfs_8c_a9af8258c3554800f6613f8147544225f}{vfs\_root}->\hyperlink{structinode_a0a54c11571f19f23322f3e6ad3ecb113}{readdir} = NULL;
104     \hyperlink{vfs_8c_a9af8258c3554800f6613f8147544225f}{vfs\_root}->\hyperlink{structinode_ab6c5e2d912fdbd506086e53185cd370d}{finddir} = NULL;
105     \hyperlink{vfs_8c_a9af8258c3554800f6613f8147544225f}{vfs\_root}->\hyperlink{structinode_ad622a049b34780786d9ba4311b06b3b4}{creat} = NULL;
106     \hyperlink{vfs_8c_a9af8258c3554800f6613f8147544225f}{vfs\_root}->\hyperlink{structinode_a5a309a9c4ada7e4d062162b06125a929}{rename} = NULL;
107     \hyperlink{vfs_8c_a9af8258c3554800f6613f8147544225f}{vfs\_root}->\hyperlink{structinode_adf65bac80736631b8000d3d34e953aaa}{unlink} = NULL;
108     \hyperlink{vfs_8c_a9af8258c3554800f6613f8147544225f}{vfs\_root}->\hyperlink{structinode_a8221183a697c9f2b4e0e295f5a9d8afd}{chown} = NULL;
109     \hyperlink{vfs_8c_a9af8258c3554800f6613f8147544225f}{vfs\_root}->\hyperlink{structinode_ae2972ef183f5c39aac7cb83b9f8a04a8}{flush} = NULL;
110     \hyperlink{vfs_8c_a9af8258c3554800f6613f8147544225f}{vfs\_root}->\hyperlink{structinode_a636843da203574bc338b016758bf8c7e}{ioctl} = NULL;
111     
112     \hyperlink{list_8h_a945ef9f05b26f6016d2f28ec8836b1f0}{list\_add}(\hyperlink{vfs_8c_ab78229df5c858687756417b32ac398ff}{list\_inodes}, (\hyperlink{list_8h_a83bc1af7566502e08756b8d8c425972e}{listval\_t}) \hyperlink{vfs_8c_a9af8258c3554800f6613f8147544225f}{vfs\_root});
113     
114     \textcolor{keywordflow}{return} 0;
115 \}
\end{DoxyCode}
\hypertarget{vfs_8c_acb87c78588a46c5526e933c495b69c2a}{\index{vfs.\+c@{vfs.\+c}!vfs\+\_\+map@{vfs\+\_\+map}}
\index{vfs\+\_\+map@{vfs\+\_\+map}!vfs.\+c@{vfs.\+c}}
\subsubsection[{vfs\+\_\+map}]{\setlength{\rightskip}{0pt plus 5cm}void vfs\+\_\+map (
\begin{DoxyParamCaption}
\item[{{\bf inode\+\_\+t} $\ast$}]{inode}
\end{DoxyParamCaption}
)}}\label{vfs_8c_acb87c78588a46c5526e933c495b69c2a}


Definizione alla linea 22 del file vfs.\+c.



Referenzia inode\+::ino, list\+\_\+add(), e nextinode.


\begin{DoxyCode}
22                              \{
23     inode->\hyperlink{structinode_a1a77be0f24a6c9a18bbdbcecfb75df7c}{ino} = (ino\_t) \hyperlink{vfs_8c_ad11ac1a0eb756180b648d9ac7d53b169}{nextinode}++;
24     \hyperlink{list_8h_a945ef9f05b26f6016d2f28ec8836b1f0}{list\_add}(\hyperlink{vfs_8c_ab78229df5c858687756417b32ac398ff}{list\_inodes}, (\hyperlink{list_8h_a83bc1af7566502e08756b8d8c425972e}{listval\_t}) inode);
25 \}
\end{DoxyCode}
\hypertarget{vfs_8c_a99334446cfc1dfc32088d838b4f2895c}{\index{vfs.\+c@{vfs.\+c}!vfs\+\_\+mapped@{vfs\+\_\+mapped}}
\index{vfs\+\_\+mapped@{vfs\+\_\+mapped}!vfs.\+c@{vfs.\+c}}
\subsubsection[{vfs\+\_\+mapped}]{\setlength{\rightskip}{0pt plus 5cm}{\bf inode\+\_\+t}$\ast$ vfs\+\_\+mapped (
\begin{DoxyParamCaption}
\item[{{\bf inode\+\_\+t} $\ast$}]{parent, }
\item[{char $\ast$}]{name}
\end{DoxyParamCaption}
)}}\label{vfs_8c_a99334446cfc1dfc32088d838b4f2895c}


Definizione alla linea 32 del file vfs.\+c.



Referenzia list\+\_\+foreach, inode\+::name, inode\+::parent, e value.


\begin{DoxyCode}
32                                                  \{
33     \hyperlink{list_8h_a1f44c976d2c698407a17fef984a5b232}{list\_foreach}(tmp, \hyperlink{vfs_8c_ab78229df5c858687756417b32ac398ff}{list\_inodes}) \{
34         \hyperlink{structinode}{inode\_t}* \hyperlink{attribute_8h_ae7f66047e6e39ba2bb6af8b95f00d1dd}{value} = (\hyperlink{structinode}{inode\_t}*) tmp;
35         
36         \textcolor{keywordflow}{if}(value->\hyperlink{structinode_a2d4fac4ae14332628e6fa2bd55dd3121}{parent} == parent)
37             \textcolor{keywordflow}{if}(strcmp(value->\hyperlink{structinode_ad64802d9d4ebdd1c56af5ab6e302faf0}{name}, \hyperlink{attribute_8h_aae08e5b919f01beb6c69d2859e0dfc27}{name}) == 0)
38                 \textcolor{keywordflow}{return} value;
39     \}
40     
41     \textcolor{keywordflow}{return} NULL;
42 \}
\end{DoxyCode}
\hypertarget{vfs_8c_a4f7b5f17ac7c4b3a0a574d9620e0512d}{\index{vfs.\+c@{vfs.\+c}!vfs\+\_\+mapped\+\_\+at\+\_\+index@{vfs\+\_\+mapped\+\_\+at\+\_\+index}}
\index{vfs\+\_\+mapped\+\_\+at\+\_\+index@{vfs\+\_\+mapped\+\_\+at\+\_\+index}!vfs.\+c@{vfs.\+c}}
\subsubsection[{vfs\+\_\+mapped\+\_\+at\+\_\+index}]{\setlength{\rightskip}{0pt plus 5cm}{\bf inode\+\_\+t}$\ast$ vfs\+\_\+mapped\+\_\+at\+\_\+index (
\begin{DoxyParamCaption}
\item[{{\bf inode\+\_\+t} $\ast$}]{parent, }
\item[{int}]{index}
\end{DoxyParamCaption}
)}}\label{vfs_8c_a4f7b5f17ac7c4b3a0a574d9620e0512d}


Definizione alla linea 44 del file vfs.\+c.



Referenzia list\+\_\+foreach, inode\+::parent, e value.


\begin{DoxyCode}
44                                                          \{
45     \hyperlink{list_8h_a1f44c976d2c698407a17fef984a5b232}{list\_foreach}(tmp, \hyperlink{vfs_8c_ab78229df5c858687756417b32ac398ff}{list\_inodes}) \{
46         \hyperlink{structinode}{inode\_t}* \hyperlink{attribute_8h_ae7f66047e6e39ba2bb6af8b95f00d1dd}{value} = (\hyperlink{structinode}{inode\_t}*) tmp;
47         
48         \textcolor{keywordflow}{if}(value->\hyperlink{structinode_a2d4fac4ae14332628e6fa2bd55dd3121}{parent} == parent)
49             index--;
50             
51         \textcolor{keywordflow}{if}(index == -1)
52             \textcolor{keywordflow}{return} \hyperlink{attribute_8h_ae7f66047e6e39ba2bb6af8b95f00d1dd}{value};
53     \}
54     
55     \textcolor{keywordflow}{return} NULL;
56 \}
\end{DoxyCode}
\hypertarget{vfs_8c_a829e1c063db610c46554db0e28cb2bcb}{\index{vfs.\+c@{vfs.\+c}!vfs\+\_\+mapped\+\_\+count@{vfs\+\_\+mapped\+\_\+count}}
\index{vfs\+\_\+mapped\+\_\+count@{vfs\+\_\+mapped\+\_\+count}!vfs.\+c@{vfs.\+c}}
\subsubsection[{vfs\+\_\+mapped\+\_\+count}]{\setlength{\rightskip}{0pt plus 5cm}int vfs\+\_\+mapped\+\_\+count (
\begin{DoxyParamCaption}
\item[{{\bf inode\+\_\+t} $\ast$}]{parent}
\end{DoxyParamCaption}
)}}\label{vfs_8c_a829e1c063db610c46554db0e28cb2bcb}


Definizione alla linea 58 del file vfs.\+c.



Referenzia list\+\_\+foreach, inode\+::parent, e value.


\begin{DoxyCode}
58                                       \{
59     \textcolor{keywordtype}{int} index = 0;
60     
61     \hyperlink{list_8h_a1f44c976d2c698407a17fef984a5b232}{list\_foreach}(tmp, \hyperlink{vfs_8c_ab78229df5c858687756417b32ac398ff}{list\_inodes}) \{
62         \hyperlink{structinode}{inode\_t}* \hyperlink{attribute_8h_ae7f66047e6e39ba2bb6af8b95f00d1dd}{value} = (\hyperlink{structinode}{inode\_t}*) tmp;
63         
64         \textcolor{keywordflow}{if}(value->\hyperlink{structinode_a2d4fac4ae14332628e6fa2bd55dd3121}{parent} == parent)
65             index++;
66     \}
67     
68     \textcolor{keywordflow}{return} index;
69 \}
\end{DoxyCode}
\hypertarget{vfs_8c_a13a7520e2fe9380c3ed93472d0c800bc}{\index{vfs.\+c@{vfs.\+c}!vfs\+\_\+umap@{vfs\+\_\+umap}}
\index{vfs\+\_\+umap@{vfs\+\_\+umap}!vfs.\+c@{vfs.\+c}}
\subsubsection[{vfs\+\_\+umap}]{\setlength{\rightskip}{0pt plus 5cm}void vfs\+\_\+umap (
\begin{DoxyParamCaption}
\item[{{\bf inode\+\_\+t} $\ast$}]{inode}
\end{DoxyParamCaption}
)}}\label{vfs_8c_a13a7520e2fe9380c3ed93472d0c800bc}


Definizione alla linea 27 del file vfs.\+c.



Referenzia kfree(), e list\+\_\+remove().


\begin{DoxyCode}
27                               \{
28     \hyperlink{list_8h_a4470c240b622941415ae5250067699b5}{list\_remove}(\hyperlink{vfs_8c_ab78229df5c858687756417b32ac398ff}{list\_inodes}, (\hyperlink{list_8h_a83bc1af7566502e08756b8d8c425972e}{listval\_t}) inode);
29     \hyperlink{mm_8h_acee1960bdb3a19cb495341ec725cafef}{kfree}(inode);
30 \}
\end{DoxyCode}


\subsection{Documentazione delle variabili}
\hypertarget{vfs_8c_ab78229df5c858687756417b32ac398ff}{\index{vfs.\+c@{vfs.\+c}!list\+\_\+inodes@{list\+\_\+inodes}}
\index{list\+\_\+inodes@{list\+\_\+inodes}!vfs.\+c@{vfs.\+c}}
\subsubsection[{list\+\_\+inodes}]{\setlength{\rightskip}{0pt plus 5cm}{\bf list\+\_\+t}$\ast$ list\+\_\+inodes = 0\hspace{0.3cm}{\ttfamily [static]}}}\label{vfs_8c_ab78229df5c858687756417b32ac398ff}


Definizione alla linea 16 del file vfs.\+c.

\hypertarget{vfs_8c_ad11ac1a0eb756180b648d9ac7d53b169}{\index{vfs.\+c@{vfs.\+c}!nextinode@{nextinode}}
\index{nextinode@{nextinode}!vfs.\+c@{vfs.\+c}}
\subsubsection[{nextinode}]{\setlength{\rightskip}{0pt plus 5cm}{\bf uint32\+\_\+t} nextinode = 0\hspace{0.3cm}{\ttfamily [static]}}}\label{vfs_8c_ad11ac1a0eb756180b648d9ac7d53b169}


Definizione alla linea 17 del file vfs.\+c.

\hypertarget{vfs_8c_a9af8258c3554800f6613f8147544225f}{\index{vfs.\+c@{vfs.\+c}!vfs\+\_\+root@{vfs\+\_\+root}}
\index{vfs\+\_\+root@{vfs\+\_\+root}!vfs.\+c@{vfs.\+c}}
\subsubsection[{vfs\+\_\+root}]{\setlength{\rightskip}{0pt plus 5cm}{\bf inode\+\_\+t}$\ast$ vfs\+\_\+root}}\label{vfs_8c_a9af8258c3554800f6613f8147544225f}


Definizione alla linea 19 del file vfs.\+c.

